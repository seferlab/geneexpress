options(warn=-1)
x=c(0.5,0.5,0.5,0.5,2.5,2.5,2.5,2.5,4.0,4.0,4.0,4.0,5.0,5.0,5.0,5.0,6.0,6.0,6.0,6.0,9.0,9.0,9.0,9.0,9.5,9.5,9.5,9.5,10.0,10.0,10.0,10.0,26.0,26.0,26.0,26.0)
y=c(0.0,0.253,-0.216,-0.216,0.655)
rempoints=c(1.5,1.5,1.5,1.5,1.0,1.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,3.0,3.0,3.0,3.0,3.0,4.5,4.5,4.5,4.5,7.0,7.0,7.0,7.0,7.0,8.0,8.0,8.0,8.0,11.0,11.0,11.0,11.0,12.0,12.0,12.0,12.0,13.0,13.0,13.0,13.0,14.0,14.0,14.0,14.0,15.0,15.0,15.0,15.0,16.0,16.0,16.0,16.0,17.0,17.0,17.0,17.0,18.0,18.0,18.0,18.0,19.0,19.0,19.0,19.0,20.0,20.0,20.0,21.0,21.0,21.0,21.0,22.0,22.0,22.0,22.0,23.0,23.0,23.0,23.0,24.0,24.0,24.0,24.0,25.0,25.0,25.0,25.0,13.5,13.5,13.5,12.5,12.5,12.5,12.5,6.5,6.5,6.5,6.5,8.5,8.5,8.5,8.5,10.5,10.5,10.5,10.5,3.5,3.5,3.5,3.5,11.5,11.5,11.5,11.5,7.5,7.5,5.5,5.5,5.5,5.5)
remvals=c(0.4665,-0.1655,0.4665,-0.1655,0.6245,0.6605,0.4665,-0.4585,0.8575,0.5835,0.3665,0.6245,0.3385,-0.6715,-0.4585,-0.1975,0.3665,-0.0495,0.2655,-0.4585,-0.1975,-0.0495,0.1345,-0.1655,0.3665,-0.1035,-0.2635,-0.5195,0.6245,-0.5845,-0.3605,-0.0765,-0.3605,0.1995,0.0745,0.2655,0.1345,0.1995,-0.0495,0.1995,0.0445,0.3955,0.6245,-0.2975,-0.1655,0.5415,0.1345,0.0135,0.1345,0.1345,0.3955,0.1045,-0.7795,0.1345,0.6245,1.0465,0.1045,0.1345,0.2655,0.3955,0.6245,0.4665,0.5415,0.3955,0.3955,0.3385,0.3385,0.7685,0.3385,-0.1035,0.3955,0.6965,0.3955,0.5415,0.3955,0.6245,0.3385,-0.7795,-0.1035,0.1995,0.3955,0.7685,0.6245,0.6245,0.5415,0.4665,0.6245,1.0465,0.6965,0.6245,0.5415,0.3385,-4.3665,0.1345,0.1045,0.4665,0.3385,0.2655,0.0745,0.5835,0.1345,-0.3605,-0.4305,0.4305,0.3955,-0.5195,0.4665,-0.5845,0.7685,-0.6435,-0.2305,0.0135,-0.8875,-0.2635,0.1995,0.2655,0.0135,0.2655,-1.2635,-0.3295,-0.6965,0.2325,0.3385)
l <- list("0.5" = c(-0.1345,0.1345,-0.3955,0.3015),"1.0" = c(0.6245,0.6605,0.4665,-0.4585),"2.0" = c(0.8575,0.5835,0.3665,0.6245,0.3385),"3.0" = c(-0.6715,-0.4585,-0.1975,0.3665,-0.0495),"4.0" = c(0.1995,0.1345,0.1345,0.0745),"5.0" = c(-1.7595,-0.2975,0.3385,-0.1345),"1.5" = c(0.4665,-0.1655,0.4665,-0.1655),"7.0" = c(0.1345,-0.1655,0.3665,-0.1035,-0.2635),"8.0" = c(-0.5195,0.6245,-0.5845,-0.3605),"9.0" = c(0.4665,0.0135,-0.8615,0.0135),"10.0" = c(-0.2975,-0.5195,0.3955,-0.1345),"11.0" = c(-0.0765,-0.3605,0.1995,0.0745),"12.0" = c(0.2655,0.1345,0.1995,-0.0495),"13.0" = c(0.1995,0.0445,0.3955,0.6245),"14.0" = c(-0.2975,-0.1655,0.5415,0.1345),"15.0" = c(0.0135,0.1345,0.1345,0.3955),"16.0" = c(0.1045,-0.7795,0.1345,0.6245),"17.0" = c(1.0465,0.1045,0.1345,0.2655),"18.0" = c(0.3955,0.6245,0.4665,0.5415),"19.0" = c(0.3955,0.3955,0.3385,0.3385),"20.0" = c(0.7685,0.3385,-0.1035),"21.0" = c(0.3955,0.6965,0.3955,0.5415),"22.0" = c(0.3955,0.6245,0.3385,-0.7795),"23.0" = c(-0.1035,0.1995,0.3955,0.7685),"24.0" = c(0.6245,0.6245,0.5415,0.4665),"25.0" = c(0.6245,1.0465,0.6965,0.6245),"26.0" = c(0.4665,0.5415,0.7685,0.7685),"11.5" = c(-0.2635,0.1995,0.2655,0.0135),"12.5" = c(0.1345,0.1045,0.4665,0.3385),"6.5" = c(0.2655,0.0745,0.5835,0.1345),"6.0" = c(0.4665,0.1995,-0.1655,0.3955),"7.5" = c(0.2655,-1.2635),"8.5" = c(-0.3605,-0.4305,0.4305,0.3955),"9.5" = c(-0.9135,-0.1035,0.1045,-2.4365),"10.5" = c(-0.5195,0.4665,-0.5845,0.7685),"3.5" = c(-0.6435,-0.2305,0.0135,-0.8875),"2.5" = c(-0.0495,0.4665,0.3385,0.1675),"13.5" = c(0.5415,0.3385,-4.3665),"5.5" = c(-0.3295,-0.6965,0.2325,0.3385),"4.5" = c(0.2655,-0.4585,-0.1975,-0.0495))
spl <- smooth.spline(x,y,cv=TRUE)
sumval = 0.0
for(ind in seq_along(rempoints)){
   sumval = sumval + (predict(spl,rempoints[ind])$y - remvals[ind])**2;}
outerr <- list()
for(item in names(l)){
varsum = 0.0
for(item2 in l[[item]]){
   varsum = varsum + (item2-predict(spl,as.numeric(item))$y)**2 }
outerr[[item]] = varsum }
fileConn<-file("out.txt","w")
write(format(sumval), fileConn)
write("error",fileConn, append=TRUE)
write(sapply(names(l),function(x) paste(x,paste(outerr[[x]],collapse=))), fileConn, append=TRUE)
write("knots",fileConn, append=TRUE)
write(format(spl$fit$knot),fileConn, append=TRUE)
close(fileConn)
